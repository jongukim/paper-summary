# Emergent Tool Use From Multi-Agent Autocurricula

- from OpenAI
- [Paper](https://arxiv.org/abs/1909.07528), [Blog](https://openai.com/blog/emergent-tool-use/)

## 논문을 한 번 읽어봤습니다

- 28 페이지로 아주 상세
- ~~코드도 공개되어 있으면 좋겠지만 아마 이해 못하겠지~~
- 숨바꼭질
- 에이전트는 3가지 액션을 할 수 있다: move, grab, lock
- 에이전트에게 도구에 대한 설명을 미리 해주지 않았다
- 장소를 너무 많이 벗어나지 않도록 패널티를 줬다
- 리워드는 팀에게 준다: 숨는 팀은 한 명이라도 눈에 띄면 감점을 받는다
- 장애물이 없으면 찾는 팀이 유리한 세팅
  - 그래서 벽, 박스, 램프가 주어진다
  - 물체의 위치나 개수는 환경마다 랜덤하게 주어진다 (학습이 꽤나 robust하게 진행되었다는 것)

## 핵심 내용

### 무언가 창조적인(emergent) 움직임을 보인다

- AutoCurricula라고 거창하게 이름 붙인 이유다
- ~~틀린 말은 아니다~~

### 6번의 큰 성장이 있었다

- [1] running & chasing
  - 찾는 팀 유리
  - 멀리 도망가면 패널티를 받는다
- [2] fort building
  - 박스로 벽을 쌓아서 수비하기 시작
  - 숨는 팀 유리
- [3] ramp use
  - 램프를 타고 벽을 넘기 시작
  - 다시 찾는 팀이 유리
- [4] ramp defense
  - 램프를 못쓰게 만듦
  - 숨는 팀이 다시 유리
  - 4분의 1 크기의 방을 강제한 세팅에서는 램프를 락할 수 없도록 했다고 한다
    - 그래서 램프를 들고 방으로 가져왔던 것 ~~대단하다 이것도~~
- [5] box surfing
  - 물리 엔진의 버그를 찾아내고야 말았다
  - Robust 물리 엔진은 RL 실험에서 아주 중요한 요소 ([실패 예](https://twitter.com/OpenAI/status/1174039602757160961?s=20))
- [6] surf defense
  - 그것도 못하게 막는 숨는 팀
  - 모든 상자와 램프를 잠궈버린다

성장에는 경쟁이 필수일까?

## 리워드는 심플하다

- 그럼에도 이런 성장을 한다는 것은 의미있다
- 사람이 상세하게 리워드 함수를 설계하는 것은 비용도 많이 들고 스케일러블하지 않다

## Team

- 폴리시는 공유
  - 에이전트마다 옵저베이션이 다르니 액션은 다르게 하지만 뇌는 같다는 의미
  - 숨는 에이전트의 개수나 램프의 개수, 상자의 개수 등을 학습 때보다 늘려도 나름 잘 동작했다고 함
    - 학습한 폴리시가 꽤 의미 있다는 것을 나타낸다고 본다
- 협업하는 모습을 보여준다
  - 팀이 잘해야 리워드를 받게 했더니 협업을 알아서 하더라는 것

## 생각해볼 것

- 준비 시간에 많은 박스를 잠궈버리고, 6단계에서는 다 잠궈버리는데...
  - 이전에도 그렇게 할 수 있었다는 것인데, 그렇게 하지 않았다는 점
- 에이전트가 잘 하고 있는지 측정하는 것이 쉽지 않다
  - 1대1 대결이 아니라서 ELO나 TrueSkill을 사용하지도 못한다

## 배워보고 싶은 것

- 보이지 않는 엔티티를 마스킹 하는 것
- LSTM을 장기적으로 쓰는 것

## 음식(food pellet) 세팅

- 고정된 위치에 음식을 두면 그 위치에 집을 짓고 지켰으며,
- 음식을 먹고 나면 다른 곳에 새롭게 나타나도록 세팅(공간의 중앙 근처에서 다시 생성되긴 함)하면 중앙에 큰 공간을 만들려고 노력하기도 했다고
- 이 세팅에서는 음식이 나오는 위치가 너무 크면 포기하고 그냥 작은 집 짓고 자기들 지키는데만 노력한다고 함
- 음식 전체를 지키고 술래가 음식을 노리도록 한 세팅에서는 술래를 구석으로 밀어버리는 재밌는 결과를 얻었다 ([참고 영상](https://twitter.com/OpenAI/status/1174815179483172864?s=20))
  - 본래는 음식을 최대한 보호할 수 있는 큰 집을 지을 것이라고 기대했다고 한다

## 기타

- 학습된 것을 트랜스퍼 했을 때 엄청난 효과가 있었던 건 아니지만 없다고 말하기도 어려운 애매한 결과
